
<script type="text/html" data-help-name="TDengineServer">
    <p>Add the credentials for accessing your database here.</p>
    <p>Timezone can be set like GMT, EST5EDT, UTC, etc</p>
    <p>The Charset defaults to the "old" 3 byte TDengine UTF8. If you need support for emojis etc then use UTF8MB4.</p>
</script>

<script type="text/html" data-help-name="tdengine">
    <p><b>TDengine Database Node</b></p>
    <p>Provides SQL execution interface for TDengine write and query operations.</p>

    <h3>Features</h3>
    <ul>
        <li>Supports all TDengine SQL operations (SELECT/INSERT/CREATE/etc.)</li>
        <li>Unified interface for both read and write operations (SQL passed via <code>msg.topic</code>)</li>
        <li>Auto-detects query types (SELECT/SHOW/DESC/EXPLAIN) vs write operations</li>
    </ul>

    <h3>Node Status</h3>
    <div class="node-status-list">
        <p><i class="fa fa-circle status-dot status-connecting"></i> Connecting (Gray)</p>
        <p><i class="fa fa-circle status-dot status-connected"></i> Operational (Green)</p>
        <p><i class="fa fa-circle status-dot status-error"></i> Error (Red)</p>
    </div>

    <h3>Input Format</h3>
    <pre><code class="javascript">msg = {
    topic: "SQL statement",  // Required
    payload: { ... }         // Optional additional parameters
}</code></pre>
    <p>Special characters and escape sequences must follow JSON string specifications</p>

    <h3>Output Format</h3>
    <h4>Write Operations (INSERT/CREATE/etc.)</h4>
    <pre><code class="javascript">{
    topic: "Original SQL statement",
    payload: {
        affectRows: 2,   // Affected rows count
        totalTime: 3,    // Total execution time (ms)
        timing: 1683311  // Server-side execution time (ns)
    }
}</code></pre>

    <h4>Query Operations (SELECT/SHOW/etc.)</h4>
    <pre><code class="javascript">{
    topic: "Original SQL statement",
    payload: [
        { ts: 1749609744733n, current: 1, voltage: 1, phase: 5 },
        { ts: 1749609200554n, current: 1, voltage: 1, phase: 4 },
        ...
    ]
}</code></pre>
    <p>Data type mapping reference:
        <a href="https://docs.taosdata.com/reference/connector/node/" target="_blank">
            TDengine NodeJS Connector Type Mapping
        </a>
    </p>

    <h3>Error Handling</h3>
    <ul>
        <li>Errors automatically throw exceptions (no msg passed downstream)</li>
        <li>Use Catch node to handle errors</li>
        <li>Error logs contain full error objects and TDengine native error codes</li>
        <li>Node status changes to <code>Error</code> on failure</li>
    </ul>

    <h3>Logging Configuration</h3>
    <pre><code class="json">// settings.js
logging: {
    level: "info"  // Supported: error, warn, info, debug, trace
}</code></pre>
    <ul>
        <li>Log format: [Timestamp] [Node Name] Capitalized English description</li>
        <li>Supported levels: error, warn, info, debug</li>
        <li>Logs are English-only</li>
    </ul>

    <h3>Usage Examples</h3>
    <div class="node-help-examples">
        <p><b>Insert Data:</b></p>
        <pre><code class="javascript">msg.topic = "INSERT INTO meters 
               VALUES (NOW, 10.2, 219, 0.32)";</code></pre>

        <p><b>Query Data:</b></p>
        <pre><code class="javascript">msg.topic = "SELECT * FROM meters 
               WHERE voltage > 220";</code></pre>
    </div>
</script>
